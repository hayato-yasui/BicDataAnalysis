import pandas as pd
from Common.DB.SQLServer_Client import SQLServerClient
from Common.DB.sql import *
from Common.util import Util


class Sample:
    def __init__(self):
        self.sql_cli = SQLServerClient()
        self.util = Util()

    def sample(self):
        item_cd_li = ['4971850913894', '4901121208169', '4950190349723', '8710103789086',
                      '0010942221555', '4541887012534', '4548736016835', '4548736047853',
                      '4548736063075', '4548736064782', '4548736070042', '4549526191923',
                      '4906128185680', '4968929019250', '4548736011564', '4548736058941',
                      '4548736059733', '4548736063013', '4548736063259', '4548736065079',
                      '4548736065086', '4548736065260', '4548736065567', '4562117085388',
                      '4571411187322', '4580445700032', '4901301733818', '4902580517854',
                      '4968929024391', '4968929027118', '4975514057726', '3168430231375',
                      '4054278088402', '4056800251001', '4522064600362', '4536117007190',
                      '4540790121739', '4548736012578', '4548736044487', '4548736059276',
                      '4548736064805', '4548736069299', '4548736070387', '4548736071650',
                      '4548848219711', '4549077311061', '4549077750396', '4549980040775',
                      '4549980071427', '4562344358118', '4562378461594', '4562481516747',
                      '4573211151299', '4901301282088', '4901301289469', '4901301310378',
                      '4901301348418', '4901750152604', '4902430751988', '4902430782708',
                      '4902530686616', '4902777389844', '4902806330359', '4902901744242',
                      '4903111331314', '4903111382965', '4903301130987', '4903301216124',
                      '4903601672606', '4906274011307', '4955595097378', '4957812581912',
                      '4961317140741', '4962752006258', '4968929019267', '4969929248145',
                      '4971710315608', '4972444010203', '4974305213877', '4974305215796',
                      '4983771905339', '4984824667051', '4984824809253', '4987188163405', '4987241139392']
        self.util.extract_tgt_data(self.sql_cli, item_cd_li, does_output=True, dir='./data/Input/', file_name='85JAN.csv')


if __name__ == '__main__':
    s = Sample()
    s.sample()
    print("END")
